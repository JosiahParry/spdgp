[{"path":"https://josiahparry.github.io/spdgp/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 spdgp authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://josiahparry.github.io/spdgp/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Josiah Parry. Author. Wenbo Lv. Author, maintainer. Edzer Pebesma. Contributor.","code":""},{"path":"https://josiahparry.github.io/spdgp/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Parry J, Lv W (2025). spdgp: Simulate Spatial Data Generation Processes. R package version 0.1.0, https://github.com/josiahparry/spdgp, https://josiahparry.github.io/spdgp/.","code":"@Manual{,   title = {spdgp: Simulate Spatial Data Generation Processes},   author = {Josiah Parry and Wenbo Lv},   year = {2025},   note = {R package version 0.1.0, https://github.com/josiahparry/spdgp},   url = {https://josiahparry.github.io/spdgp/}, }"},{"path":"https://josiahparry.github.io/spdgp/index.html","id":"spatial-data-generation-processes","dir":"","previous_headings":"","what":"Simulate Spatial Data Generation Processes","title":"Simulate Spatial Data Generation Processes","text":"spdgp R port pysal module dgp within spreg library. spdgp designed around spdep package’s listw object representing spatial weights matrices.","code":""},{"path":"https://josiahparry.github.io/spdgp/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Simulate Spatial Data Generation Processes","text":"Use spdgp generate data following models: OLS: sim_ols() Spatial Error Model (SEM): sim_sem() Spatial Lag Model (SAR): sim_sar() Spatially Lagged X Model (SLX): sim_slx() Spatial Lagged X Error Model (SLX Error): sim_slx_error() Spatial Autoregressive Model Autoregressive Errors (SARAR / SAC / “Combo” model): sim_sarar() Spatial Durbin Model: sim_durbin() General Nested Model (GNM): sim_gns() Matrix Exponential Spatial Lag Model (MESS): sim_mess()","code":""},{"path":"https://josiahparry.github.io/spdgp/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Simulate Spatial Data Generation Processes","text":"spdgp can installed github using:","code":"if (!requireNamespace(\"pak\")) {     install.packages(\"pak\") }  pak::pak(\"josiahparry/spdgp\")"},{"path":"https://josiahparry.github.io/spdgp/index.html","id":"basic-usage","dir":"","previous_headings":"","what":"Basic usage:","title":"Simulate Spatial Data Generation Processes","text":"first need create spatial weights matrix simulate based : Next can simulate error term, x betas. Next, ’ll simulate y specify autoregrssive parameter ρ=0.5\\rho = 0.5. Fit SAR model using simulated data. model can see estimate rho quite close specified value 0.5.","code":"library(spdgp)  n <- 50 listw <- sim_grid_listw(10, 5) # simulate error  u <- make_error(n, method = \"normal\")  # simulate x values based on uniform distribution x <- make_x(n, method = \"uniform\")  # create x's according to an intercept and beta value x_beta <- make_xb(x, c(1, 5)) # simulate y from error and the x_beta y <- sim_sar(u, x_beta, listw, rho = 0.5) library(spatialreg)  sar_mod <- lagsarlm(y ~ x$x_1, listw = listw)  summary(sar_mod) #>  #> Call:lagsarlm(formula = y ~ x$x_1, listw = listw) #>  #> Residuals: #>       Min        1Q    Median        3Q       Max  #> -3.100635 -0.377549  0.042234  0.703459  2.810884  #>  #> Type: lag  #> Coefficients: (asymptotic standard errors)  #>             Estimate Std. Error z value Pr(>|z|) #> (Intercept)  0.49641    0.97505  0.5091   0.6107 #> x$x_1        4.98587    0.19082 26.1281   <2e-16 #>  #> Rho: 0.52947, LR test value: 54.755, p-value: 1.3656e-13 #> Asymptotic standard error: 0.050408 #>     z-value: 10.504, p-value: < 2.22e-16 #> Wald statistic: 110.33, p-value: < 2.22e-16 #>  #> Log likelihood: -83.83562 for lag model #> ML residual variance (sigma squared): 1.5825, (sigma: 1.258) #> Number of observations: 50  #> Number of parameters estimated: 4  #> AIC: 175.67, (AIC for lm: 228.43) #> LM test for residual autocorrelation #> test value: 1.8893, p-value: 0.16928"},{"path":"https://josiahparry.github.io/spdgp/reference/make_error.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate an error term — make_error","title":"Simulate an error term — make_error","text":"Simulate error term","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_error.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate an error term — make_error","text":"","code":"make_error(   n = 10,   mu = 0,   var = 1,   method = c(\"normal\", \"laplace\", \"cauchy\", \"lognormal\") )"},{"path":"https://josiahparry.github.io/spdgp/reference/make_error.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate an error term — make_error","text":"n number values simulate. mu sample average. var sample variance. sqrt(var) passed rnorm() rlnorm() normal laplace distributions. sqrt(var / 2) used laplace() . method must one \"normal\", \"laplace\", \"cauchy\", \"lognormal\".","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_error.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate an error term — make_error","text":"numeric vector","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_error.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate an error term — make_error","text":"\"normal\": fit rnorm() \"laplace\": fit smoothmest::rdoublex() \"cauchy\": fit rcauchy() \"lognormal\": fit rlnorm()","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_square_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a square grid — make_square_grid","title":"Create a square grid — make_square_grid","text":"Creates square grid ncol nrow dimensions.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_square_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a square grid — make_square_grid","text":"","code":"make_square_grid(nrow, ncol = nrow)"},{"path":"https://josiahparry.github.io/spdgp/reference/make_square_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a square grid — make_square_grid","text":"nrow number rows grid. ncol defaults nrow. number columns grid.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_square_grid.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a square grid — make_square_grid","text":"","code":"make_square_grid(3, 2) #> Geometry set for 6 features  #> Geometry type: POLYGON #> Dimension:     XY #> Bounding box:  xmin: 0 ymin: 0 xmax: 2 ymax: 3 #> CRS:           NA #> First 5 geometries: #> POLYGON ((0 0, 1 0, 1 1, 0 1, 0 0)) #> POLYGON ((1 0, 2 0, 2 1, 1 1, 1 0)) #> POLYGON ((0 1, 1 1, 1 2, 0 2, 0 1)) #> POLYGON ((1 1, 2 1, 2 2, 1 2, 1 1)) #> POLYGON ((0 2, 1 2, 1 3, 0 3, 0 2))"},{"path":"https://josiahparry.github.io/spdgp/reference/make_wx.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Spatial Lags of variables — make_wx","title":"Create Spatial Lags of variables — make_wx","text":"Given dataframe numeric values spatial weights matrix, calculate spatial lag variable.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_wx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Spatial Lags of variables — make_wx","text":"","code":"make_wx(x, listw, order = NULL)"},{"path":"https://josiahparry.github.io/spdgp/reference/make_wx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Spatial Lags of variables — make_wx","text":"x data.frame independent variables generated make_x(). listw listw object generated sim_grid_listw(). order unused.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_wx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Spatial Lags of variables — make_wx","text":"data.frame spatially lagged variables.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_wx.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Spatial Lags of variables — make_wx","text":"","code":"listw <- sim_grid_listw(10, 10) x_vars <- make_x(100, mu = c(0.5, 1.2), var = c(1, 0.5))  res <- make_wx(x_vars, listw) head(res) #>     x_1_lag  x_2_lag #> 1 2.1753107 1.957174 #> 2 1.2230313 1.373702 #> 3 1.0538553 1.374858 #> 4 0.9457799 1.331713 #> 5 1.0683191 1.602990 #> 6 1.0438814 1.362660"},{"path":"https://josiahparry.github.io/spdgp/reference/make_wxg.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the effect of spatially lagged X variables — make_wxg","title":"Calculate the effect of spatially lagged X variables — make_wxg","text":"function computes contribution spatially lagged X variables based provided coefficients. function takes spatially lagged variables (wx, see make_wx()) multiplies corresponding regression coefficients (gamma), returning predicted influence spatial lags. spatial lags considered; original X variables included calculation.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_wxg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the effect of spatially lagged X variables — make_wxg","text":"","code":"make_wxg(wx, gamma)"},{"path":"https://josiahparry.github.io/spdgp/reference/make_wxg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the effect of spatially lagged X variables — make_wxg","text":"wx matrix spatially lagged x variables. gamma vector coefficients spatially lagged x variables. length must match number columns wx.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_wxg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the effect of spatially lagged X variables — make_wxg","text":"numeric vector","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_wxg.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the effect of spatially lagged X variables — make_wxg","text":"","code":"grid <- make_square_grid(5) listw <- spdep::nb2listw(spdep::poly2nb(grid)) x <- make_x(25, c(0,1), c(1,4)) wx <- make_wx(x, listw) gamma <- c(1.75, 0.4) make_wxg(wx, gamma)  #>  [1] 5.485891 4.176288 3.033108 3.522886 3.116918 4.415962 4.762772 4.128422 #>  [9] 4.032427 3.541543 5.699027 4.719449 4.575163 4.515919 5.625042 4.059987 #> [17] 4.660237 4.677603 4.975429 5.360746 4.993139 5.152251 4.870010 5.326420 #> [25] 6.248927"},{"path":"https://josiahparry.github.io/spdgp/reference/make_x.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate X variables — make_x_bivariate","title":"Simulate X variables — make_x_bivariate","text":"Simulates independent variables.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_x.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate X variables — make_x_bivariate","text":"","code":"make_x_bivariate(n = 5, mu = 1, cor = 0.25, var = c(1, 1))  make_x_uniform(n = 5, var = 1)  make_x_normal(n = 5, mu = 0, var = 1)  make_x(   n = 5,   mu = 0,   var = 1,   cor = 0,   method = c(\"uniform\", \"normal\", \"bivnormal\") )"},{"path":"https://josiahparry.github.io/spdgp/reference/make_x.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate X variables — make_x_bivariate","text":"n number values simulate. mu sample average. cor correlation bivariate normal var sample variance. sqrt(var) passed rnorm() rlnorm() normal laplace distributions. sqrt(var / 2) used laplace() . method must one \"uniform\" (default), \"normal\", \"bivnormal\" (bivariate normal).","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_x.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate X variables — make_x_bivariate","text":"data.frame simulated independent variables.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_x.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate X variables — make_x_bivariate","text":"","code":"make_x(10, mu = c(0.5, 1.2), var = c(1, 0.5))  #>          x_1       x_2 #> 1  1.7628590 0.3082836 #> 2  1.4454462 2.2979954 #> 3  2.5182247 1.9627152 #> 4  2.2090075 1.8568446 #> 5  1.3732044 1.3045129 #> 6  3.3237453 1.3393927 #> 7  1.0345818 0.2349710 #> 8  0.1739019 0.9512587 #> 9  1.9959718 0.4221742 #> 10 0.7548479 1.6919259"},{"path":"https://josiahparry.github.io/spdgp/reference/make_xb.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate predicted X values based on coefficients — make_xb","title":"Calculate predicted X values based on coefficients — make_xb","text":"function calculates predicted x values based regression coefficients. results function can passed sim_*() functions.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_xb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate predicted X values based on coefficients — make_xb","text":"","code":"make_xb(x, beta)"},{"path":"https://josiahparry.github.io/spdgp/reference/make_xb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate predicted X values based on coefficients — make_xb","text":"x data.frame independent variables generated make_x(). beta vector beta coefficients variables. must ncol(x) + 1 values. first element vector intercept.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_xb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate predicted X values based on coefficients — make_xb","text":"numeric vector","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_xb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate predicted X values based on coefficients — make_xb","text":"","code":"x <- make_x(25, c(0,1), c(1,4)) betas <- c(1, 1.5, -2) make_xb(x, betas) #>  [1]  -1.11345578   5.00760431   0.26685336  -6.95484038   0.01315884 #>  [6]  -4.85035563   2.40743533  -6.23276219  -7.72870528   3.19964091 #> [11]  -0.35676565  -0.12569310   1.85552885 -10.66832705   0.30153068 #> [16]  -8.47825224  -4.91882171  -1.53868422  -8.16142521  -0.85349384 #> [21]   3.35121449  -9.66492260   1.25437653  -9.44993324   2.31102659"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_durbin.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate the Spatial Durbin Model — sim_durbin","title":"Simulate the Spatial Durbin Model — sim_durbin","text":"Simulate Spatial Durbin Model","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_durbin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate the Spatial Durbin Model — sim_durbin","text":"","code":"sim_durbin(u, xb, wxg, listw, rho = 0.5)"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_durbin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate the Spatial Durbin Model — sim_durbin","text":"u error vector xb predicted x values calculated make_xb() wxg predicted spatial lag effect calculated make_wxg() listw listw object generated sim_grid_listw(). rho spatial autoregressive coefficient spatially lagged dependent variable.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_durbin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate the Spatial Durbin Model — sim_durbin","text":"numeric vector","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_durbin.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulate the Spatial Durbin Model — sim_durbin","text":"spreg.dgp.dgp_spdurbin","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_durbin.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate the Spatial Durbin Model — sim_durbin","text":"","code":"ncol <- 20 n <- ncol^2 listw <- sim_grid_listw(ncol, ncol)  # Create spatial weights for a grid u <- make_error(n)  # Simulate random errors x <- make_x(   n,   mu = c(0.25, 5),   var = c(1, 0.75),   method = \"normal\" )  # Generate x variables  # create xb with intercept = 1, beta1 = 2, beta2 = -3 xb <- make_xb(x, c(1, 2, -3)) wx <- make_wx(x, listw) wxg <- make_wxg(wx, c(-2, 1.5)) y <- sim_durbin(u, xb, wxg, listw, rho = 0.5)  # combine data  df <- cbind(y = y, x)  # fit SDM spatialreg::lagsarlm(y ~ ., df, listw, Durbin = TRUE) #>  #> Call: #> spatialreg::lagsarlm(formula = y ~ ., data = df, listw = listw,  #>     Durbin = TRUE) #> Type: mixed  #>  #> Coefficients: #>         rho (Intercept)         x_1         x_2     lag.x_1     lag.x_2  #>   0.3725901   2.0088068   2.0910376  -2.9380981  -1.6759722   0.8912780  #>  #> Log likelihood: -581.025"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_error.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate Spatial Error Process — sim_error","title":"Simulate Spatial Error Process — sim_error","text":"function generates pure spatial error process, useful want simulate error structure without including deterministic part (.e., xb term). can used analyze simulate behavior spatially dependent errors isolation.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_error.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate Spatial Error Process — sim_error","text":"","code":"sim_error(u, listw, lambda = 0.5, model = c(\"sar\", \"ma\"))"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_error.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate Spatial Error Process — sim_error","text":"u error vector listw listw object generated sim_grid_listw(). lambda value value -1 1. spatial autoregressive coefficient error term. model default \"sar\". model simulated. Provide \"ma\" moving average.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_error.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate Spatial Error Process — sim_error","text":"numeric vector","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_error.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulate Spatial Error Process — sim_error","text":"See spreg.dgp.dgp_errproc","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_error.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate Spatial Error Process — sim_error","text":"","code":"listw <- sim_grid_listw(5)  u <- make_error(25) sim_error(u, listw) #>  [1]  1.44113298  1.06192938  0.62039368  3.06497032  3.43851209  1.67072025 #>  [7] -0.67648774  0.85430425  1.58967407  0.46169945  1.78216038  0.97565794 #> [13]  0.78904675 -0.16057308  1.41110958  0.37216518 -0.35058399  1.60513442 #> [19]  1.33026876  1.29947401  0.43106292 -0.64301630  1.38834405  0.06371485 #> [25]  0.18934935"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_gns.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate General Nested Model — sim_gns","title":"Simulate General Nested Model — sim_gns","text":"Simulate General Nested Model","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_gns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate General Nested Model — sim_gns","text":"","code":"sim_gns(u, xb, wxg, listw, rho = 0.5, lambda = 0.2, model = c(\"sar\", \"ma\"))"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_gns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate General Nested Model — sim_gns","text":"u error vector xb predicted x values calculated make_xb() wxg predicted spatial lag effect calculated make_wxg() listw listw object generated sim_grid_listw(). rho spatial autoregressive coefficient spatially lagged dependent variable. lambda value value -1 1. spatial autoregressive coefficient error term. model default \"sar\". model simulated. Provide \"ma\" moving average.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_gns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate General Nested Model — sim_gns","text":"numeric vector","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_gns.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulate General Nested Model — sim_gns","text":"spreg.dgp.dgp_gns","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_grid_listw.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate spatial weights matrix for a grid — sim_grid_listw","title":"Generate spatial weights matrix for a grid — sim_grid_listw","text":"Create spatial weights matrix based square grid structure.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_grid_listw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate spatial weights matrix for a grid — sim_grid_listw","text":"","code":"sim_grid_listw(nrow, ncol = nrow, style = \"W\", type = c(\"queen\", \"rook\"))"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_grid_listw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate spatial weights matrix for a grid — sim_grid_listw","text":"nrow number rows grid. ncol defaults nrow. number columns grid. style spatial weights style. Defaults row standardized. See spdep::nb2listw() . type default \"queen\". Can also \"rook\".","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_grid_listw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate spatial weights matrix for a grid — sim_grid_listw","text":"listw object spdep package.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_grid_listw.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate spatial weights matrix for a grid — sim_grid_listw","text":"","code":"sim_grid_listw(10, 5) #> Characteristics of weights list object: #> Neighbour list object: #> Number of regions: 50  #> Number of nonzero links: 314  #> Percentage nonzero weights: 12.56  #> Average number of links: 6.28  #>  #> Weights style: W  #> Weights constants summary: #>    n   nn S0       S1       S2 #> W 50 2500 50 16.82458 203.3558"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_mess.html","id":null,"dir":"Reference","previous_headings":"","what":"Simiulate Matrix Exponential Spatial Lag Model — sim_mess","title":"Simiulate Matrix Exponential Spatial Lag Model — sim_mess","text":"Simiulate Matrix Exponential Spatial Lag Model","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_mess.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simiulate Matrix Exponential Spatial Lag Model — sim_mess","text":"","code":"sim_mess(u, xb, listw, rho = 0.5)"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_mess.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simiulate Matrix Exponential Spatial Lag Model — sim_mess","text":"u error vector xb predicted x values calculated make_xb() listw listw object generated sim_grid_listw(). rho spatial autoregressive coefficient spatially lagged dependent variable.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_mess.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simiulate Matrix Exponential Spatial Lag Model — sim_mess","text":"numeric vector","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_mess.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simiulate Matrix Exponential Spatial Lag Model — sim_mess","text":"dgp_mess","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_ols.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate OLS — sim_ols","title":"Simulate OLS — sim_ols","text":"Simulate y variable Ordinary Least Squares (OLS) regression.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_ols.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate OLS — sim_ols","text":"","code":"sim_ols(u, xb)"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_ols.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate OLS — sim_ols","text":"u error vector xb predicted x values calculated make_xb()","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_ols.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate OLS — sim_ols","text":"numeric vector","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_ols.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulate OLS — sim_ols","text":"spreg.dgp.dgp_ols","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_ols.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate OLS — sim_ols","text":"","code":"u <- make_error(50, method = \"normal\") x <- make_x(50) xb <- make_xb(x, c(1,2)) y <- sim_ols(u, xb) lm(y ~ x[[1]]) #>  #> Call: #> lm(formula = y ~ x[[1]]) #>  #> Coefficients: #> (Intercept)       x[[1]]   #>       1.253        1.898   #>"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sar.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate Spatial Lag Model (SAR) — sim_sar","title":"Simulate Spatial Lag Model (SAR) — sim_sar","text":"Simulate y SAR model.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate Spatial Lag Model (SAR) — sim_sar","text":"","code":"sim_sar(u, xb, listw, rho = 0.5)"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate Spatial Lag Model (SAR) — sim_sar","text":"u error vector xb predicted x values calculated make_xb() listw listw object generated sim_grid_listw(). rho spatial autoregressive coefficient spatially lagged dependent variable.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate Spatial Lag Model (SAR) — sim_sar","text":"numeric vector","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sar.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulate Spatial Lag Model (SAR) — sim_sar","text":"spreg.dgp.dgp_lag","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate Spatial Lag Model (SAR) — sim_sar","text":"","code":"ncol <- 20 n <- ncol^2 listw <- sim_grid_listw(ncol, ncol)  # Create spatial weights for a grid u <- make_error(n)  # Simulate random errors x <- make_x(   n,   mu = c(0.25, 5),   var = c(1, 0.75),   method = \"normal\" )  # Generate x variables  # create xb with intercept = 1, beta1 = 2, beta2 = -3 xb <- make_xb(x, c(1, 2, -3)) y <- sim_sar(u, xb, listw)  # combine data  df <- cbind(y = y, x)  # fit SAR model # Note lambda, x_1, and x_2 estimates. spatialreg::stsls(y ~ ., df, listw) #>  #> Call: #> spatialreg::stsls(formula = y ~ ., data = df, listw = listw) #>  #> Coefficients: #>         Rho (Intercept)         x_1         x_2  #>   0.5066124   1.2694876   2.0348833  -3.0126382  #>"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sarar.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate the Spatial Autoregressive Model with Autoregressive Errors — sim_sarar","title":"Simulate the Spatial Autoregressive Model with Autoregressive Errors — sim_sarar","text":"Generate y values \"combo\" / SARAR / SAC model.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sarar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate the Spatial Autoregressive Model with Autoregressive Errors — sim_sarar","text":"","code":"sim_sarar(u, xb, listw, rho = 0.5, lambda = 0.2, model = c(\"sar\", \"ma\"))"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sarar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate the Spatial Autoregressive Model with Autoregressive Errors — sim_sarar","text":"u error vector xb predicted x values calculated make_xb() listw listw object generated sim_grid_listw(). rho spatial autoregressive coefficient spatially lagged dependent variable. lambda value value -1 1. spatial autoregressive coefficient error term. model default \"sar\". model simulated. Provide \"ma\" moving average.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sarar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate the Spatial Autoregressive Model with Autoregressive Errors — sim_sarar","text":"numeric vector","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sarar.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulate the Spatial Autoregressive Model with Autoregressive Errors — sim_sarar","text":"spreg.dgp.dgp_lagerr","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sem.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate Spatial Error Model (SEM) — sim_sem","title":"Simulate Spatial Error Model (SEM) — sim_sem","text":"Simulate y values SEM model.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sem.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate Spatial Error Model (SEM) — sim_sem","text":"","code":"sim_sem(u, xb, listw, lambda = 0.5, model = c(\"sar\", \"ma\"))"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sem.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate Spatial Error Model (SEM) — sim_sem","text":"u error vector xb predicted x values calculated make_xb() listw listw object generated sim_grid_listw(). lambda value value -1 1. spatial autoregressive coefficient error term. model default \"sar\". model simulated. Provide \"ma\" moving average.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sem.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate Spatial Error Model (SEM) — sim_sem","text":"numeric vector","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sem.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulate Spatial Error Model (SEM) — sim_sem","text":"spreg.dgp.dgp_sperror","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sem.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate Spatial Error Model (SEM) — sim_sem","text":"","code":"ncol <- 10 n <- ncol^2 listw <- sim_grid_listw(ncol, ncol)  # Create spatial weights for a grid u <- make_error(n)  # Simulate random errors x <- make_x(   n,   mu = c(0.25, 5),   var = c(1, 0.75),   method = \"normal\" )  # Generate x variables  # create xb with intercept = 1, beta1 = 2, beta2 = -3 xb <- make_xb(x, c(1, 2, -3)) y <- sim_sem(u, xb, listw)  # combine data  df <- cbind(y = y, x)  # fit SEM model # Note lambda, x_1, and x_2 estimates. spatialreg::errorsarlm(y ~ ., df, listw) #>  #> Call: #> spatialreg::errorsarlm(formula = y ~ ., data = df, listw = listw) #> Type: error  #>  #> Coefficients: #>      lambda (Intercept)         x_1         x_2  #>   0.4207722  -0.7156728   2.1358333  -2.6173289  #>  #> Log likelihood: -143.7965"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_slx.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate Spatially Lagged X (SLX) model — sim_slx","title":"Simulate Spatially Lagged X (SLX) model — sim_slx","text":"function simulates y values SLX model, dependent variable influenced original spatially lagged x variables.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_slx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate Spatially Lagged X (SLX) model — sim_slx","text":"","code":"sim_slx(u, xb, wxg)"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_slx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate Spatially Lagged X (SLX) model — sim_slx","text":"u error vector xb predicted x values calculated make_xb() wxg predicted spatial lag effect calculated make_wxg()","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_slx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate Spatially Lagged X (SLX) model — sim_slx","text":"numeric vector","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_slx.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulate Spatially Lagged X (SLX) model — sim_slx","text":"spreg.dgp.dgp_slx","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_slx.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate Spatially Lagged X (SLX) model — sim_slx","text":"","code":"ncol <- 20 n <- ncol^2 listw <- sim_grid_listw(ncol, ncol)  # Create spatial weights for a grid u <- make_error(n, method = \"normal\")  # Simulate random errors x <- make_x(n, method = \"uniform\")  # Generate x variables xb <- make_xb(x, c(1, 2))  # Calculate xb using the original x and coefficients wx <- make_wx(x, listw)  # Generate spatially lagged x variables wxg <- make_wxg(wx, 0.5)  # Calculate the effect of the spatial lags y <- sim_slx(u, xb, wxg)  # Simulate the SLX model outcome df <- data.frame(y, x) spatialreg::lmSLX(y ~ ., data = df, listw = listw)  # Estimate the SLX model #>  #> Call: #> lm(y ~ x_1 + lag.x_1, data = df, listw = listw) #>  #> Coefficients: #> (Intercept)          x_1      lag.x_1   #>      1.2991       1.9596       0.3903   #>"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_slx_error.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate Spatially Lagged X Error Model — sim_slx_error","title":"Simulate Spatially Lagged X Error Model — sim_slx_error","text":"Simulate Spatially Lagged X Error Model","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_slx_error.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate Spatially Lagged X Error Model — sim_slx_error","text":"","code":"sim_slx_error(u, xb, wxg, listw, lambda = 0.5, model = c(\"sar\", \"ma\"))"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_slx_error.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate Spatially Lagged X Error Model — sim_slx_error","text":"u error vector xb predicted x values calculated make_xb() wxg predicted spatial lag effect calculated make_wxg() listw listw object generated sim_grid_listw(). lambda value value -1 1. spatial autoregressive coefficient error term. model default \"sar\". model simulated. Provide \"ma\" moving average.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_slx_error.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate Spatially Lagged X Error Model — sim_slx_error","text":"numeric vector","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_slx_error.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulate Spatially Lagged X Error Model — sim_slx_error","text":"spreg.dgp.dgp_slxerror","code":""},{"path":"https://josiahparry.github.io/spdgp/news/index.html","id":"spdgp-010","dir":"Changelog","previous_headings":"","what":"spdgp 0.1.0","title":"spdgp 0.1.0","text":"Initial CRAN submission.","code":""}]
