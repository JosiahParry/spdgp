[{"path":"https://josiahparry.github.io/spdgp/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Josiah Parry. Author, maintainer.","code":""},{"path":"https://josiahparry.github.io/spdgp/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Parry J (2024). spdgp: Simulate Spatial Data Generation Processes. R package version 0.0.0.9000, https://josiahparry.github.io/spdgp/.","code":"@Manual{,   title = {spdgp: Simulate Spatial Data Generation Processes},   author = {Josiah Parry},   year = {2024},   note = {R package version 0.0.0.9000},   url = {https://josiahparry.github.io/spdgp/}, }"},{"path":"https://josiahparry.github.io/spdgp/index.html","id":"spatial-data-generation-processes","dir":"","previous_headings":"","what":"Simulate Spatial Data Generation Processes","title":"Simulate Spatial Data Generation Processes","text":"spdgp R port pysal module dgp within spreg library. spdgp designed around spdep package’s listw object representing spatial weights matrices.","code":""},{"path":"https://josiahparry.github.io/spdgp/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Simulate Spatial Data Generation Processes","text":"Use spdgp generate data following models: OLS: sim_ols() Spatial Error Model (SEM): sim_sem() Spatial Lag Model (SAR): sim_sar() Spatially Lagged X Model (SLX): sim_slx() Spatial Lagged X Error Model (SLX Error): sim_slx_error() Spatial Autoregressive Model Autoregressive Errors (SARAR / SAC / “Combo” model): sim_sarar() Spatial Durbin Model: sim_durbin() General Nested Model (GNM): sim_gns() Matrix Exponential Spatial Lag Model (MESS): sim_mess()","code":""},{"path":"https://josiahparry.github.io/spdgp/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Simulate Spatial Data Generation Processes","text":"spdgp can installed github using:","code":"if (!requireNamespace(\"pak\")) {     install.packages(\"pak\") }  pak::pak(\"josiahparry/spdgp\")"},{"path":"https://josiahparry.github.io/spdgp/index.html","id":"basic-usage","dir":"","previous_headings":"","what":"Basic usage:","title":"Simulate Spatial Data Generation Processes","text":"first need create spatial weights matrix simulate based : Next can simulate error term, x betas. Next, ’ll simulate y specify autoregrssive parameter ρ=0.5\\rho = 0.5. Fit SAR model using simulated data. model can see estimate rho quite close specified value 0.5.","code":"library(spdgp)  n <- 50 listw <- sim_grid_listw(10, 5) # simulate error  u <- make_error(n, method = \"normal\")  # simulate x values based on uniform distribution x <- make_x(n, method = \"uniform\")  # create x's according to an intercept and beta value x_beta <- make_xb(x, c(1, 5)) # simulate y from error and the x_beta y <- sim_sar(u, x_beta, listw, rho = 0.5) library(spatialreg)  sar_mod <- lagsarlm(y ~ x$x_1, listw = listw)  summary(sar_mod) #>  #> Call:lagsarlm(formula = y ~ x$x_1, listw = listw) #>  #> Residuals: #>       Min        1Q    Median        3Q       Max  #> -3.100635 -0.377549  0.042234  0.703459  2.810884  #>  #> Type: lag  #> Coefficients: (asymptotic standard errors)  #>             Estimate Std. Error z value Pr(>|z|) #> (Intercept)  0.49641    0.97505  0.5091   0.6107 #> x$x_1        4.98587    0.19082 26.1281   <2e-16 #>  #> Rho: 0.52947, LR test value: 54.755, p-value: 1.3656e-13 #> Asymptotic standard error: 0.050408 #>     z-value: 10.504, p-value: < 2.22e-16 #> Wald statistic: 110.33, p-value: < 2.22e-16 #>  #> Log likelihood: -83.83562 for lag model #> ML residual variance (sigma squared): 1.5825, (sigma: 1.258) #> Number of observations: 50  #> Number of parameters estimated: 4  #> AIC: 175.67, (AIC for lm: 228.43) #> LM test for residual autocorrelation #> test value: 1.8893, p-value: 0.16928"},{"path":"https://josiahparry.github.io/spdgp/reference/make_error.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate an error term — make_error","title":"Simulate an error term — make_error","text":"Simulate error term","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_error.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate an error term — make_error","text":"","code":"make_error(   n = 10,   mu = 0,   var = 1,   method = c(\"normal\", \"laplace\", \"cauchy\", \"lognormal\") )"},{"path":"https://josiahparry.github.io/spdgp/reference/make_error.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate an error term — make_error","text":"n number values simulate mu sample average. var sample variance. sqrt(var) passed rnorm() rlnorm() normal laplace distributions. sqrt(var / 2) used laplace() method must one \"normal\", \"laplace\", \"cauchy\", \"lognormal\".","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_error.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate an error term — make_error","text":"\"normal\": fit rnorm() \"laplace\": fit smoothmest::rdoublex() \"cauchy\": fit rcauchy() \"lognormal\": fit rlnorm()","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_square_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a square grid — make_square_grid","title":"Create a square grid — make_square_grid","text":"Creates square grid ncol nrow dimensions.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_square_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a square grid — make_square_grid","text":"","code":"make_square_grid(nrow, ncol = nrow)"},{"path":"https://josiahparry.github.io/spdgp/reference/make_square_grid.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a square grid — make_square_grid","text":"","code":"make_square_grid(3, 2) #> Geometry set for 6 features  #> Geometry type: POLYGON #> Dimension:     XY #> Bounding box:  xmin: 0 ymin: 0 xmax: 2 ymax: 3 #> CRS:           NA #> First 5 geometries: #> POLYGON ((0 0, 1 0, 1 1, 0 1, 0 0)) #> POLYGON ((1 0, 2 0, 2 1, 1 1, 1 0)) #> POLYGON ((0 1, 1 1, 1 2, 0 2, 0 1)) #> POLYGON ((1 1, 2 1, 2 2, 1 2, 1 1)) #> POLYGON ((0 2, 1 2, 1 3, 0 3, 0 2))"},{"path":"https://josiahparry.github.io/spdgp/reference/make_wx.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Spatial Lags of variables — make_wx","title":"Create Spatial Lags of variables — make_wx","text":"Given dataframe numeric values spatial weights matrix, calculate spatial lag variable.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_wx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Spatial Lags of variables — make_wx","text":"","code":"make_wx(x, listw, order = NULL)"},{"path":"https://josiahparry.github.io/spdgp/reference/make_wx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Spatial Lags of variables — make_wx","text":"order unused.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_x.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate X variables — make_x_bivariate","title":"Simulate X variables — make_x_bivariate","text":"Simulates independent variables.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_x.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate X variables — make_x_bivariate","text":"","code":"make_x_bivariate(n = 5, mu = 1, cor = 0.25, var = c(1, 1))  make_x_uniform(n = 5, var = 1)  make_x_normal(n = 5, mu = 0, var = 1)  make_x(   n = 5,   mu = 0,   var = 1,   cor = 0,   method = c(\"uniform\", \"normal\", \"bivnormal\") )"},{"path":"https://josiahparry.github.io/spdgp/reference/make_x.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate X variables — make_x_bivariate","text":"n number values simulate mu sample average. cor correlation bivariate normal var sample variance. sqrt(var) passed rnorm() rlnorm() normal laplace distributions. sqrt(var / 2) used laplace() method must one \"uniform\" (default), \"normal\", \"bivnormal\" (bivariate normal)","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/make_x.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate X variables — make_x_bivariate","text":"","code":"make_x(10, mu = c(0.5, 1.2), var = c(1, 0.5))  #>           x_1        x_2 #> 1  0.27972668 2.14232535 #> 2  2.89021442 0.42851527 #> 3  2.08109676 0.08387379 #> 4  0.54458602 0.78478156 #> 5  0.02563242 0.98549889 #> 6  1.61563447 0.47929125 #> 7  1.72435146 0.98846248 #> 8  1.00378318 0.15593809 #> 9  2.53877767 0.95211988 #> 10 2.67609301 2.38959442"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_durbin.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate the Spatial Durbin Model — sim_durbin","title":"Simulate the Spatial Durbin Model — sim_durbin","text":"Simulate Spatial Durbin Model","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_durbin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate the Spatial Durbin Model — sim_durbin","text":"","code":"sim_durbin(u, xb, wxg, listw, rho = 0.5)"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_durbin.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulate the Spatial Durbin Model — sim_durbin","text":"spreg.dgp.dgp_spdurbin","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_error.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate Spatial Error Model — sim_error","title":"Simulate Spatial Error Model — sim_error","text":"Simulate Spatial Error Model","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_error.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate Spatial Error Model — sim_error","text":"","code":"sim_error(u, listw, lambda = 0.5, model = c(\"sar\", \"ma\"))"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_error.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulate Spatial Error Model — sim_error","text":"See spreg.dgp.dgp_errproc","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_gns.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate General Nested Model — sim_gns","title":"Simulate General Nested Model — sim_gns","text":"Simulate General Nested Model","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_gns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate General Nested Model — sim_gns","text":"","code":"sim_gns(u, xb, wxg, listw, rho = 0.5, lambda = 0.2, model = c(\"sar\", \"ma\"))"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_gns.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulate General Nested Model — sim_gns","text":"spreg.dgp.dgp_gns","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_grid_listw.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate spatial weights matrix for a grid — sim_grid_listw","title":"Generate spatial weights matrix for a grid — sim_grid_listw","text":"Create spatial weights matrix based square grid structure.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_grid_listw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate spatial weights matrix for a grid — sim_grid_listw","text":"","code":"sim_grid_listw(nrow, ncol = ncol, style = \"W\", type = c(\"queen\", \"rook\"))"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_grid_listw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate spatial weights matrix for a grid — sim_grid_listw","text":"nrow number rows grid. ncol defaults nrow. number columns grid. style spatial weights style. Defaults row standardized. See spdep::nb2listw() . type default \"queen\". Can also \"rook\".","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_grid_listw.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate spatial weights matrix for a grid — sim_grid_listw","text":"","code":"sim_grid_listw(10, 5) #> Characteristics of weights list object: #> Neighbour list object: #> Number of regions: 50  #> Number of nonzero links: 314  #> Percentage nonzero weights: 12.56  #> Average number of links: 6.28  #>  #> Weights style: W  #> Weights constants summary: #>    n   nn S0       S1       S2 #> W 50 2500 50 16.82458 203.3558"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_mess.html","id":null,"dir":"Reference","previous_headings":"","what":"Simiulate Matrix Exponential Spatial Lag Model — sim_mess","title":"Simiulate Matrix Exponential Spatial Lag Model — sim_mess","text":"Simiulate Matrix Exponential Spatial Lag Model","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_mess.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simiulate Matrix Exponential Spatial Lag Model — sim_mess","text":"","code":"sim_mess(u, xb, listw, rho = 0.5)"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_ols.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate OLS — sim_ols","title":"Simulate OLS — sim_ols","text":"Simulate OLS","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_ols.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate OLS — sim_ols","text":"","code":"sim_ols(u, xb)"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_ols.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulate OLS — sim_ols","text":"spreg.dgp.dgp_ols","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_ols.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate OLS — sim_ols","text":"","code":"u = make_x(50, method = \"normal\") x = make_x(50) xb = make_xb(x, c(1,2)) y <- dgp_ols(u, xb) #> Error in dgp_ols(u, xb): could not find function \"dgp_ols\" mod <- lm(y ~ x[[1]]) #> Error in eval(predvars, data, env): object 'y' not found summary(mod) #> Error: object 'mod' not found"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sar.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate Spatial Lag Model (SAR) — sim_sar","title":"Simulate Spatial Lag Model (SAR) — sim_sar","text":"Simulate Spatial Lag Model (SAR)","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate Spatial Lag Model (SAR) — sim_sar","text":"","code":"sim_sar(u, xb, listw, rho = 0.5)"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sar.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulate Spatial Lag Model (SAR) — sim_sar","text":"spreg.dgp.dgp_lag","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sarar.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate the Spatial Autoregressive Model with Autoregressive Errors — sim_sarar","title":"Simulate the Spatial Autoregressive Model with Autoregressive Errors — sim_sarar","text":"Generate y values \"combo\" / SARAR / SAC model.","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sarar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate the Spatial Autoregressive Model with Autoregressive Errors — sim_sarar","text":"","code":"sim_sarar(u, xb, listw, rho = 0.5, lambda = 0.2, model = c(\"sar\", \"ma\"))"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sarar.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulate the Spatial Autoregressive Model with Autoregressive Errors — sim_sarar","text":"spreg.dgp.dgp_lagerr","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sem.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate Spatial Error Model (SEM) — sim_sem","title":"Simulate Spatial Error Model (SEM) — sim_sem","text":"Simulate Spatial Error Model (SEM)","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sem.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate Spatial Error Model (SEM) — sim_sem","text":"","code":"sim_sem(u, xb, listw, lambda = 0.5, model = c(\"sar\", \"ma\"))"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_sem.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulate Spatial Error Model (SEM) — sim_sem","text":"spreg.dgp.dgp_sperror","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_slx.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate Spatially Lagged X (SLX) model — sim_slx","title":"Simulate Spatially Lagged X (SLX) model — sim_slx","text":"Simulate Spatially Lagged X (SLX) model","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_slx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate Spatially Lagged X (SLX) model — sim_slx","text":"","code":"sim_slx(u, xb, wxg)"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_slx.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulate Spatially Lagged X (SLX) model — sim_slx","text":"spreg.dgp.dgp_slx","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_slx.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate Spatially Lagged X (SLX) model — sim_slx","text":"","code":"n <- 100 grid <- make_grid(sqrt(n), sqrt(n)) #> Error in make_grid(sqrt(n), sqrt(n)): could not find function \"make_grid\" listw <- spdep::nb2listw(spdep::poly2nb(grid)) #> Error in spdep::poly2nb(grid): Not a polygon object u <- make_error(n, method = \"normal\") x <- make_x(n, method = \"uniform\") xb <- make_xb(x, c(1, 2)) wx <- make_wx(x, listw) #> Error: object 'listw' not found wxg <- make_wxg(wx, c(2, 2)) #> Error: object 'wx' not found y <- dgp_slx(u, xb, wxg) #> Error in dgp_slx(u, xb, wxg): could not find function \"dgp_slx\" df <- data.frame(y, x) #> Error: object 'y' not found spatialreg::lmSLX(y ~ ., data = df, listw = listw)  #> Error in model.frame.default(formula = y ~ ., data = df, drop.unused.levels = TRUE): 'data' must be a data.frame, environment, or list"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_slx_error.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate Spatially Lagged X Error Model — sim_slx_error","title":"Simulate Spatially Lagged X Error Model — sim_slx_error","text":"Simulate Spatially Lagged X Error Model","code":""},{"path":"https://josiahparry.github.io/spdgp/reference/sim_slx_error.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate Spatially Lagged X Error Model — sim_slx_error","text":"","code":"sim_slx_error(u, xb, wxg, lambda = 0.5, model = c(\"sar\", \"ma\"))"},{"path":"https://josiahparry.github.io/spdgp/reference/sim_slx_error.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulate Spatially Lagged X Error Model — sim_slx_error","text":"spreg.dgp.dgp_slxerror","code":""}]
